require 'spec_helper'

describe Vulnerability do

  context "when creating a vulnerability" do

    let(:valid_params) { { file: "test", loc: 10, rule_id: 1 } }

    it "needs the required fields" do
      parameters = valid_params
      parameters.each_key do |key|
        Vulnerability.create(parameters.except(key)).should_not be_valid
      end
    end


    it "should create a vulnerability with valid parameters" do
      Vulnerability.new(valid_params).should be_valid
    end


    it "should not create a vulnerability with invalid parameters" do
      expect do
        Vulnerability.new(file: "test", points: 1, bla: "blaaaa")
        should raise_error
      end
    end

  end

end
